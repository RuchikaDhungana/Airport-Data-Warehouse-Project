--TRANSFORM_FLIGHTS--
DROP TABLE TRANSFORM_FLIGHTS CASCADE CONSTRAINTS;
TRUNCATE TABLE TRANSFORM_FLIGHTS;
CREATE TABLE  TRANSFORM_FLIGHTS 
(	
         FLIGHTKEY NUMBER NOT NULL PRIMARY KEY,
        "FLIGHTNO" NUMBER(10,0), 
	"YEAR" NUMBER(4,0), 
	"MONTH" NUMBER(2,0), 
	"DAY" NUMBER(2,0), 
	"TAILNO" VARCHAR2(10), 
	"DBSOURCE" VARCHAR2(17)
) ;

--PROCEDURE TO TRANSFORM GOOD FLIGHTS TABLE
create or replace procedure TRANSFORM_FLIGHTS_TABLE
as 
begin
DELETE FROM TRANSFORM_FLIGHTS;
INSERT INTO TRANSFORM_FLIGHTS (SELECT * FROM GOOD_FLIGHTS);
END;

begin 
TRANSFORM_FLIGHTS_TABLE;
end;

----------------------------------------------------------------------

--TRANSFORM_COMPLAINT--
DROP TABLE TRANSFORM_COMPLAINT CASCADE CONSTRAINTS;
TRUNCATE TABLE TRANSFORM_COMPLAINT;
CREATE TABLE  TRANSFORM_COMPLAINT 
(	
COMPLAINT_KEY NUMBER NOT NULL PRIMARY KEY,
COMPLAINT_ID NUMBER NOT NULL,
"COMPLAINTTYPE" VARCHAR2(5), 
"DESCRIPTION" VARCHAR2(200), 
"COMPLAINTSTATUS" VARCHAR2(7), 
"FLIGHT_KEY" INTEGER NOT NULL,
"DBSOURCE" VARCHAR2(17) 
) ;

--PROCEDURE TO TRANSFORM GOOD COMPLAINT TABLE
create or replace procedure TRANSFORM_COMPLAINT_TABLE
as 
begin
DELETE FROM TRANSFORM_COMPLAINT;
INSERT INTO TRANSFORM_COMPLAINT (SELECT * FROM GOOD_COMPLAINTS);
END;

begin 
TRANSFORM_COMPLAINT_TABLE;
end;

----------------------------------------------------------------------

--TRANSFORM_COMPENSATION--
DROP TABLE TRANSFORM_COMPENSATION CASCADE CONSTRAINTS;
CREATE TABLE  TRANSFORM_COMPENSATION
   (	
"COMPENSATIONKEY" NUMBER(*,0) NOT NULL PRIMARY KEY, 
"COMPENSATION_AMNT" NUMBER, 
"COMPENSATION_TYPE" VARCHAR2(20), 
"FLIGHT_KEY" INTEGER NOT NULL,
"DBSOURCE" VARCHAR2(17)
 ) ;

--PROCEDURE TO TRANSFORM GOOD COMPENSATION TABLE
create or replace procedure TRANSFORM_COMPENSATION_TABLE
as 
begin
DELETE FROM TRANSFORM_COMPENSATION;
INSERT INTO TRANSFORM_COMPENSATION (SELECT * FROM GOOD_COMPENSATION);
END;

begin 
TRANSFORM_COMPENSATION_TABLE;
end;